// Code generated by conjure-go. DO NOT EDIT.

package api

import (
	"context"
	"fmt"

	"github.com/palantir/pkg/safejson"
	"github.com/palantir/pkg/safeyaml"
)

type CheckAlertState struct {
	typ                     string
	pendingReview           *PendingReviewAlertState
	closedWithFurtherAction *ClosedWithFurtherActionAlertState
	closedWithIgnore        *ClosedWithIgnoreAlertState
}

type checkAlertStateDeserializer struct {
	Type                    string                             `json:"type"`
	PendingReview           *PendingReviewAlertState           `json:"pendingReview"`
	ClosedWithFurtherAction *ClosedWithFurtherActionAlertState `json:"closedWithFurtherAction"`
	ClosedWithIgnore        *ClosedWithIgnoreAlertState        `json:"closedWithIgnore"`
}

func (u *checkAlertStateDeserializer) toStruct() CheckAlertState {
	return CheckAlertState{typ: u.Type, pendingReview: u.PendingReview, closedWithFurtherAction: u.ClosedWithFurtherAction, closedWithIgnore: u.ClosedWithIgnore}
}

func (u *CheckAlertState) toSerializer() (interface{}, error) {
	switch u.typ {
	default:
		return nil, fmt.Errorf("unknown type %q", u.typ)
	case "pendingReview":
		if u.pendingReview == nil {
			return nil, fmt.Errorf("field \"pendingReview\" is required")
		}
		return struct {
			Type          string                  `json:"type"`
			PendingReview PendingReviewAlertState `json:"pendingReview"`
		}{Type: "pendingReview", PendingReview: *u.pendingReview}, nil
	case "closedWithFurtherAction":
		if u.closedWithFurtherAction == nil {
			return nil, fmt.Errorf("field \"closedWithFurtherAction\" is required")
		}
		return struct {
			Type                    string                            `json:"type"`
			ClosedWithFurtherAction ClosedWithFurtherActionAlertState `json:"closedWithFurtherAction"`
		}{Type: "closedWithFurtherAction", ClosedWithFurtherAction: *u.closedWithFurtherAction}, nil
	case "closedWithIgnore":
		if u.closedWithIgnore == nil {
			return nil, fmt.Errorf("field \"closedWithIgnore\" is required")
		}
		return struct {
			Type             string                     `json:"type"`
			ClosedWithIgnore ClosedWithIgnoreAlertState `json:"closedWithIgnore"`
		}{Type: "closedWithIgnore", ClosedWithIgnore: *u.closedWithIgnore}, nil
	}
}

func (u CheckAlertState) MarshalJSON() ([]byte, error) {
	ser, err := u.toSerializer()
	if err != nil {
		return nil, err
	}
	return safejson.Marshal(ser)
}

func (u *CheckAlertState) UnmarshalJSON(data []byte) error {
	var deser checkAlertStateDeserializer
	if err := safejson.Unmarshal(data, &deser); err != nil {
		return err
	}
	*u = deser.toStruct()
	switch u.typ {
	case "pendingReview":
		if u.pendingReview == nil {
			return fmt.Errorf("field \"pendingReview\" is required")
		}
	case "closedWithFurtherAction":
		if u.closedWithFurtherAction == nil {
			return fmt.Errorf("field \"closedWithFurtherAction\" is required")
		}
	case "closedWithIgnore":
		if u.closedWithIgnore == nil {
			return fmt.Errorf("field \"closedWithIgnore\" is required")
		}
	}
	return nil
}

func (u CheckAlertState) MarshalYAML() (interface{}, error) {
	jsonBytes, err := safejson.Marshal(u)
	if err != nil {
		return nil, err
	}
	return safeyaml.JSONtoYAMLMapSlice(jsonBytes)
}

func (u *CheckAlertState) UnmarshalYAML(unmarshal func(interface{}) error) error {
	jsonBytes, err := safeyaml.UnmarshalerToJSONBytes(unmarshal)
	if err != nil {
		return err
	}
	return safejson.Unmarshal(jsonBytes, *&u)
}

func (u *CheckAlertState) AcceptFuncs(pendingReviewFunc func(PendingReviewAlertState) error, closedWithFurtherActionFunc func(ClosedWithFurtherActionAlertState) error, closedWithIgnoreFunc func(ClosedWithIgnoreAlertState) error, unknownFunc func(string) error) error {
	switch u.typ {
	default:
		if u.typ == "" {
			return fmt.Errorf("invalid value in union type")
		}
		return unknownFunc(u.typ)
	case "pendingReview":
		if u.pendingReview == nil {
			return fmt.Errorf("field \"pendingReview\" is required")
		}
		return pendingReviewFunc(*u.pendingReview)
	case "closedWithFurtherAction":
		if u.closedWithFurtherAction == nil {
			return fmt.Errorf("field \"closedWithFurtherAction\" is required")
		}
		return closedWithFurtherActionFunc(*u.closedWithFurtherAction)
	case "closedWithIgnore":
		if u.closedWithIgnore == nil {
			return fmt.Errorf("field \"closedWithIgnore\" is required")
		}
		return closedWithIgnoreFunc(*u.closedWithIgnore)
	}
}

func (u *CheckAlertState) PendingReviewNoopSuccess(PendingReviewAlertState) error {
	return nil
}

func (u *CheckAlertState) ClosedWithFurtherActionNoopSuccess(ClosedWithFurtherActionAlertState) error {
	return nil
}

func (u *CheckAlertState) ClosedWithIgnoreNoopSuccess(ClosedWithIgnoreAlertState) error {
	return nil
}

func (u *CheckAlertState) ErrorOnUnknown(typeName string) error {
	return fmt.Errorf("invalid value in union type. Type name: %s", typeName)
}

func (u *CheckAlertState) Accept(v CheckAlertStateVisitor) error {
	switch u.typ {
	default:
		if u.typ == "" {
			return fmt.Errorf("invalid value in union type")
		}
		return v.VisitUnknown(u.typ)
	case "pendingReview":
		if u.pendingReview == nil {
			return fmt.Errorf("field \"pendingReview\" is required")
		}
		return v.VisitPendingReview(*u.pendingReview)
	case "closedWithFurtherAction":
		if u.closedWithFurtherAction == nil {
			return fmt.Errorf("field \"closedWithFurtherAction\" is required")
		}
		return v.VisitClosedWithFurtherAction(*u.closedWithFurtherAction)
	case "closedWithIgnore":
		if u.closedWithIgnore == nil {
			return fmt.Errorf("field \"closedWithIgnore\" is required")
		}
		return v.VisitClosedWithIgnore(*u.closedWithIgnore)
	}
}

type CheckAlertStateVisitor interface {
	VisitPendingReview(v PendingReviewAlertState) error
	VisitClosedWithFurtherAction(v ClosedWithFurtherActionAlertState) error
	VisitClosedWithIgnore(v ClosedWithIgnoreAlertState) error
	VisitUnknown(typeName string) error
}

func (u *CheckAlertState) AcceptWithContext(ctx context.Context, v CheckAlertStateVisitorWithContext) error {
	switch u.typ {
	default:
		if u.typ == "" {
			return fmt.Errorf("invalid value in union type")
		}
		return v.VisitUnknownWithContext(ctx, u.typ)
	case "pendingReview":
		if u.pendingReview == nil {
			return fmt.Errorf("field \"pendingReview\" is required")
		}
		return v.VisitPendingReviewWithContext(ctx, *u.pendingReview)
	case "closedWithFurtherAction":
		if u.closedWithFurtherAction == nil {
			return fmt.Errorf("field \"closedWithFurtherAction\" is required")
		}
		return v.VisitClosedWithFurtherActionWithContext(ctx, *u.closedWithFurtherAction)
	case "closedWithIgnore":
		if u.closedWithIgnore == nil {
			return fmt.Errorf("field \"closedWithIgnore\" is required")
		}
		return v.VisitClosedWithIgnoreWithContext(ctx, *u.closedWithIgnore)
	}
}

type CheckAlertStateVisitorWithContext interface {
	VisitPendingReviewWithContext(ctx context.Context, v PendingReviewAlertState) error
	VisitClosedWithFurtherActionWithContext(ctx context.Context, v ClosedWithFurtherActionAlertState) error
	VisitClosedWithIgnoreWithContext(ctx context.Context, v ClosedWithIgnoreAlertState) error
	VisitUnknownWithContext(ctx context.Context, typeName string) error
}

func NewCheckAlertStateFromPendingReview(v PendingReviewAlertState) CheckAlertState {
	return CheckAlertState{typ: "pendingReview", pendingReview: &v}
}

func NewCheckAlertStateFromClosedWithFurtherAction(v ClosedWithFurtherActionAlertState) CheckAlertState {
	return CheckAlertState{typ: "closedWithFurtherAction", closedWithFurtherAction: &v}
}

func NewCheckAlertStateFromClosedWithIgnore(v ClosedWithIgnoreAlertState) CheckAlertState {
	return CheckAlertState{typ: "closedWithIgnore", closedWithIgnore: &v}
}
