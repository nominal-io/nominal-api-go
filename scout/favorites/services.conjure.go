// Code generated by conjure-go. DO NOT EDIT.

package favorites

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/api/rids"
	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	"github.com/nominal-io/nominal-api-go/scout/favorites/api"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
Creating favorites allows users to pin specific resources (i.e. assets, workbooks, etc.) as favorites for
quick access within search pages throughout the application for themselves.
*/
type FavoritesServiceClient interface {
	// Retrieves the favorites list for the current user in the specified workspace.
	GetFavoritesList(ctx context.Context, authHeader bearertoken.Token, workspaceRidArg rids.WorkspaceRid, resourceTypesArg []api.ResourceType) (api.FavoritesListResponse, error)
	// Overwrites the favorites list for the current user in the specified workspace.
	SetFavoritesList(ctx context.Context, authHeader bearertoken.Token, workspaceRidArg rids.WorkspaceRid, requestArg api.SetFavoritesListRequest) (api.FavoritesListResponse, error)
}

type favoritesServiceClient struct {
	client httpclient.Client
}

func NewFavoritesServiceClient(client httpclient.Client) FavoritesServiceClient {
	return &favoritesServiceClient{client: client}
}

func (c *favoritesServiceClient) GetFavoritesList(ctx context.Context, authHeader bearertoken.Token, workspaceRidArg rids.WorkspaceRid, resourceTypesArg []api.ResourceType) (api.FavoritesListResponse, error) {
	var defaultReturnVal api.FavoritesListResponse
	var returnVal *api.FavoritesListResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetFavoritesList"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/favorites/workspace/%s", url.PathEscape(fmt.Sprint(workspaceRidArg))))
	queryParams := make(url.Values)
	for _, v := range resourceTypesArg {
		queryParams.Add("resourceTypes", fmt.Sprint(v))
	}
	requestParams = append(requestParams, httpclient.WithQueryValues(queryParams))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getFavoritesList failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getFavoritesList response cannot be nil")
	}
	return *returnVal, nil
}

func (c *favoritesServiceClient) SetFavoritesList(ctx context.Context, authHeader bearertoken.Token, workspaceRidArg rids.WorkspaceRid, requestArg api.SetFavoritesListRequest) (api.FavoritesListResponse, error) {
	var defaultReturnVal api.FavoritesListResponse
	var returnVal *api.FavoritesListResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SetFavoritesList"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("PUT"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/favorites/workspace/%s", url.PathEscape(fmt.Sprint(workspaceRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "setFavoritesList failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "setFavoritesList response cannot be nil")
	}
	return *returnVal, nil
}

/*
Creating favorites allows users to pin specific resources (i.e. assets, workbooks, etc.) as favorites for
quick access within search pages throughout the application for themselves.
*/
type FavoritesServiceClientWithAuth interface {
	// Retrieves the favorites list for the current user in the specified workspace.
	GetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, resourceTypesArg []api.ResourceType) (api.FavoritesListResponse, error)
	// Overwrites the favorites list for the current user in the specified workspace.
	SetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, requestArg api.SetFavoritesListRequest) (api.FavoritesListResponse, error)
}

func NewFavoritesServiceClientWithAuth(client FavoritesServiceClient, authHeader bearertoken.Token) FavoritesServiceClientWithAuth {
	return &favoritesServiceClientWithAuth{client: client, authHeader: authHeader}
}

type favoritesServiceClientWithAuth struct {
	client     FavoritesServiceClient
	authHeader bearertoken.Token
}

func (c *favoritesServiceClientWithAuth) GetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, resourceTypesArg []api.ResourceType) (api.FavoritesListResponse, error) {
	return c.client.GetFavoritesList(ctx, c.authHeader, workspaceRidArg, resourceTypesArg)
}

func (c *favoritesServiceClientWithAuth) SetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, requestArg api.SetFavoritesListRequest) (api.FavoritesListResponse, error) {
	return c.client.SetFavoritesList(ctx, c.authHeader, workspaceRidArg, requestArg)
}

func NewFavoritesServiceClientWithTokenProvider(client FavoritesServiceClient, tokenProvider httpclient.TokenProvider) FavoritesServiceClientWithAuth {
	return &favoritesServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type favoritesServiceClientWithTokenProvider struct {
	client        FavoritesServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *favoritesServiceClientWithTokenProvider) GetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, resourceTypesArg []api.ResourceType) (api.FavoritesListResponse, error) {
	var defaultReturnVal api.FavoritesListResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetFavoritesList(ctx, bearertoken.Token(token), workspaceRidArg, resourceTypesArg)
}

func (c *favoritesServiceClientWithTokenProvider) SetFavoritesList(ctx context.Context, workspaceRidArg rids.WorkspaceRid, requestArg api.SetFavoritesListRequest) (api.FavoritesListResponse, error) {
	var defaultReturnVal api.FavoritesListResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SetFavoritesList(ctx, bearertoken.Token(token), workspaceRidArg, requestArg)
}
