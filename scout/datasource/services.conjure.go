// Code generated by conjure-go. DO NOT EDIT.

package datasource

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/api/rids"
	"github.com/nominal-io/nominal-api-go/datasource/api"
	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	api1 "github.com/nominal-io/nominal-api-go/io/nominal/api"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
Data sources are data input to runs, including databases, CSV, video, and streaming data. They contain channels that represent the series data.
The DataSource Service is responsible for indexing and searching channels across data sources.
*/
type DataSourceServiceClient interface {
	// Returns channels that match the search criteria. Results are sorted by similarity score.
	SearchChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchChannelsRequest) (api.SearchChannelsResponse, error)
	// Returns channels that match the search criteria. Results are sorted by similarity score.
	SearchFilteredChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchFilteredChannelsRequest) (api.SearchFilteredChannelsResponse, error)
	// Returns only channels that are direct children of the parent. Returns results sorted alphabetically.
	SearchHierarchicalChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchHierarchicalChannelsRequest) (api.SearchHierarchicalChannelsResponse, error)
	/*
	   Indexes the channel prefix tree for a specified data source. This operation constructs a prefix tree from the
	   channels available in the data source.
	*/
	IndexChannelPrefixTree(ctx context.Context, authHeader bearertoken.Token, requestArg api.IndexChannelPrefixTreeRequest) (api.ChannelPrefixTree, error)
	/*
	   Returns the channel prefix tree for each of the specified data sources. If the tree for a data source has not
	   been indexed, it will be omitted from the map.
	*/
	BatchGetChannelPrefixTrees(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetChannelPrefixTreeRequest) (api.BatchGetChannelPrefixTreeResponse, error)
	/*
	   Returns the the set of all tag keys and their values that are available for the specified channel given an
	   initial set of filters.
	*/
	GetAvailableTagsForChannel(ctx context.Context, authHeader bearertoken.Token, requestArg api.GetAvailableTagsForChannelRequest) (api.GetAvailableTagsForChannelResponse, error)
	/*
	   Returns the maximum data timestamps for the specified data scopes. Responses are returned
	   in the same order as requests.
	*/
	GetDataScopeBounds(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetDataScopeBoundsRequest) (api.BatchGetDataScopeBoundsResponse, error)
	/*
	   Returns available tag values for a given data source for a set of tag keys. For Nominal data sources, a time
	   range can be provided to filter tag values to those present within the months spanned by the range. If no
	   time range is provided, this defaults to the last month. For external data sources, the range must not be
	   specified, as all tag values are returned.
	*/
	GetTagValuesForDataSource(ctx context.Context, authHeader bearertoken.Token, dataSourceRidArg rids.DataSourceRid, requestArg api.GetTagValuesForDataSourceRequest) (map[api1.TagName][]api1.TagValue, error)
}

type dataSourceServiceClient struct {
	client httpclient.Client
}

func NewDataSourceServiceClient(client httpclient.Client) DataSourceServiceClient {
	return &dataSourceServiceClient{client: client}
}

func (c *dataSourceServiceClient) SearchChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchChannelsRequest) (api.SearchChannelsResponse, error) {
	var defaultReturnVal api.SearchChannelsResponse
	var returnVal *api.SearchChannelsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchChannels"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/search-channels"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(queryArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchChannels failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchChannels response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) SearchFilteredChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchFilteredChannelsRequest) (api.SearchFilteredChannelsResponse, error) {
	var defaultReturnVal api.SearchFilteredChannelsResponse
	var returnVal *api.SearchFilteredChannelsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchFilteredChannels"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/search-filtered-channels"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(queryArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchFilteredChannels failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchFilteredChannels response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) SearchHierarchicalChannels(ctx context.Context, authHeader bearertoken.Token, queryArg api.SearchHierarchicalChannelsRequest) (api.SearchHierarchicalChannelsResponse, error) {
	var defaultReturnVal api.SearchHierarchicalChannelsResponse
	var returnVal *api.SearchHierarchicalChannelsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchHierarchicalChannels"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/search-hierarchical-channels"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(queryArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchHierarchicalChannels failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchHierarchicalChannels response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) IndexChannelPrefixTree(ctx context.Context, authHeader bearertoken.Token, requestArg api.IndexChannelPrefixTreeRequest) (api.ChannelPrefixTree, error) {
	var defaultReturnVal api.ChannelPrefixTree
	var returnVal *api.ChannelPrefixTree
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("IndexChannelPrefixTree"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/index-channel-prefix-tree"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "indexChannelPrefixTree failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "indexChannelPrefixTree response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) BatchGetChannelPrefixTrees(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetChannelPrefixTreeRequest) (api.BatchGetChannelPrefixTreeResponse, error) {
	var defaultReturnVal api.BatchGetChannelPrefixTreeResponse
	var returnVal *api.BatchGetChannelPrefixTreeResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchGetChannelPrefixTrees"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/batch-get-channel-prefix-tree"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchGetChannelPrefixTrees failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchGetChannelPrefixTrees response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) GetAvailableTagsForChannel(ctx context.Context, authHeader bearertoken.Token, requestArg api.GetAvailableTagsForChannelRequest) (api.GetAvailableTagsForChannelResponse, error) {
	var defaultReturnVal api.GetAvailableTagsForChannelResponse
	var returnVal *api.GetAvailableTagsForChannelResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetAvailableTagsForChannel"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/get-available-tags"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getAvailableTagsForChannel failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getAvailableTagsForChannel response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) GetDataScopeBounds(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetDataScopeBoundsRequest) (api.BatchGetDataScopeBoundsResponse, error) {
	var defaultReturnVal api.BatchGetDataScopeBoundsResponse
	var returnVal *api.BatchGetDataScopeBoundsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetDataScopeBounds"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/get-data-scope-bounds"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getDataScopeBounds failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getDataScopeBounds response cannot be nil")
	}
	return *returnVal, nil
}

func (c *dataSourceServiceClient) GetTagValuesForDataSource(ctx context.Context, authHeader bearertoken.Token, dataSourceRidArg rids.DataSourceRid, requestArg api.GetTagValuesForDataSourceRequest) (map[api1.TagName][]api1.TagValue, error) {
	var returnVal map[api1.TagName][]api1.TagValue
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetTagValuesForDataSource"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/v1/data-sources/%s/get-tags", url.PathEscape(fmt.Sprint(dataSourceRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return nil, werror.WrapWithContextParams(ctx, err, "getTagValuesForDataSource failed")
	}
	if returnVal == nil {
		return nil, werror.ErrorWithContextParams(ctx, "getTagValuesForDataSource response cannot be nil")
	}
	return returnVal, nil
}

/*
Data sources are data input to runs, including databases, CSV, video, and streaming data. They contain channels that represent the series data.
The DataSource Service is responsible for indexing and searching channels across data sources.
*/
type DataSourceServiceClientWithAuth interface {
	// Returns channels that match the search criteria. Results are sorted by similarity score.
	SearchChannels(ctx context.Context, queryArg api.SearchChannelsRequest) (api.SearchChannelsResponse, error)
	// Returns channels that match the search criteria. Results are sorted by similarity score.
	SearchFilteredChannels(ctx context.Context, queryArg api.SearchFilteredChannelsRequest) (api.SearchFilteredChannelsResponse, error)
	// Returns only channels that are direct children of the parent. Returns results sorted alphabetically.
	SearchHierarchicalChannels(ctx context.Context, queryArg api.SearchHierarchicalChannelsRequest) (api.SearchHierarchicalChannelsResponse, error)
	/*
	   Indexes the channel prefix tree for a specified data source. This operation constructs a prefix tree from the
	   channels available in the data source.
	*/
	IndexChannelPrefixTree(ctx context.Context, requestArg api.IndexChannelPrefixTreeRequest) (api.ChannelPrefixTree, error)
	/*
	   Returns the channel prefix tree for each of the specified data sources. If the tree for a data source has not
	   been indexed, it will be omitted from the map.
	*/
	BatchGetChannelPrefixTrees(ctx context.Context, requestArg api.BatchGetChannelPrefixTreeRequest) (api.BatchGetChannelPrefixTreeResponse, error)
	/*
	   Returns the the set of all tag keys and their values that are available for the specified channel given an
	   initial set of filters.
	*/
	GetAvailableTagsForChannel(ctx context.Context, requestArg api.GetAvailableTagsForChannelRequest) (api.GetAvailableTagsForChannelResponse, error)
	/*
	   Returns the maximum data timestamps for the specified data scopes. Responses are returned
	   in the same order as requests.
	*/
	GetDataScopeBounds(ctx context.Context, requestArg api.BatchGetDataScopeBoundsRequest) (api.BatchGetDataScopeBoundsResponse, error)
	/*
	   Returns available tag values for a given data source for a set of tag keys. For Nominal data sources, a time
	   range can be provided to filter tag values to those present within the months spanned by the range. If no
	   time range is provided, this defaults to the last month. For external data sources, the range must not be
	   specified, as all tag values are returned.
	*/
	GetTagValuesForDataSource(ctx context.Context, dataSourceRidArg rids.DataSourceRid, requestArg api.GetTagValuesForDataSourceRequest) (map[api1.TagName][]api1.TagValue, error)
}

func NewDataSourceServiceClientWithAuth(client DataSourceServiceClient, authHeader bearertoken.Token) DataSourceServiceClientWithAuth {
	return &dataSourceServiceClientWithAuth{client: client, authHeader: authHeader}
}

type dataSourceServiceClientWithAuth struct {
	client     DataSourceServiceClient
	authHeader bearertoken.Token
}

func (c *dataSourceServiceClientWithAuth) SearchChannels(ctx context.Context, queryArg api.SearchChannelsRequest) (api.SearchChannelsResponse, error) {
	return c.client.SearchChannels(ctx, c.authHeader, queryArg)
}

func (c *dataSourceServiceClientWithAuth) SearchFilteredChannels(ctx context.Context, queryArg api.SearchFilteredChannelsRequest) (api.SearchFilteredChannelsResponse, error) {
	return c.client.SearchFilteredChannels(ctx, c.authHeader, queryArg)
}

func (c *dataSourceServiceClientWithAuth) SearchHierarchicalChannels(ctx context.Context, queryArg api.SearchHierarchicalChannelsRequest) (api.SearchHierarchicalChannelsResponse, error) {
	return c.client.SearchHierarchicalChannels(ctx, c.authHeader, queryArg)
}

func (c *dataSourceServiceClientWithAuth) IndexChannelPrefixTree(ctx context.Context, requestArg api.IndexChannelPrefixTreeRequest) (api.ChannelPrefixTree, error) {
	return c.client.IndexChannelPrefixTree(ctx, c.authHeader, requestArg)
}

func (c *dataSourceServiceClientWithAuth) BatchGetChannelPrefixTrees(ctx context.Context, requestArg api.BatchGetChannelPrefixTreeRequest) (api.BatchGetChannelPrefixTreeResponse, error) {
	return c.client.BatchGetChannelPrefixTrees(ctx, c.authHeader, requestArg)
}

func (c *dataSourceServiceClientWithAuth) GetAvailableTagsForChannel(ctx context.Context, requestArg api.GetAvailableTagsForChannelRequest) (api.GetAvailableTagsForChannelResponse, error) {
	return c.client.GetAvailableTagsForChannel(ctx, c.authHeader, requestArg)
}

func (c *dataSourceServiceClientWithAuth) GetDataScopeBounds(ctx context.Context, requestArg api.BatchGetDataScopeBoundsRequest) (api.BatchGetDataScopeBoundsResponse, error) {
	return c.client.GetDataScopeBounds(ctx, c.authHeader, requestArg)
}

func (c *dataSourceServiceClientWithAuth) GetTagValuesForDataSource(ctx context.Context, dataSourceRidArg rids.DataSourceRid, requestArg api.GetTagValuesForDataSourceRequest) (map[api1.TagName][]api1.TagValue, error) {
	return c.client.GetTagValuesForDataSource(ctx, c.authHeader, dataSourceRidArg, requestArg)
}

func NewDataSourceServiceClientWithTokenProvider(client DataSourceServiceClient, tokenProvider httpclient.TokenProvider) DataSourceServiceClientWithAuth {
	return &dataSourceServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type dataSourceServiceClientWithTokenProvider struct {
	client        DataSourceServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *dataSourceServiceClientWithTokenProvider) SearchChannels(ctx context.Context, queryArg api.SearchChannelsRequest) (api.SearchChannelsResponse, error) {
	var defaultReturnVal api.SearchChannelsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchChannels(ctx, bearertoken.Token(token), queryArg)
}

func (c *dataSourceServiceClientWithTokenProvider) SearchFilteredChannels(ctx context.Context, queryArg api.SearchFilteredChannelsRequest) (api.SearchFilteredChannelsResponse, error) {
	var defaultReturnVal api.SearchFilteredChannelsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchFilteredChannels(ctx, bearertoken.Token(token), queryArg)
}

func (c *dataSourceServiceClientWithTokenProvider) SearchHierarchicalChannels(ctx context.Context, queryArg api.SearchHierarchicalChannelsRequest) (api.SearchHierarchicalChannelsResponse, error) {
	var defaultReturnVal api.SearchHierarchicalChannelsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchHierarchicalChannels(ctx, bearertoken.Token(token), queryArg)
}

func (c *dataSourceServiceClientWithTokenProvider) IndexChannelPrefixTree(ctx context.Context, requestArg api.IndexChannelPrefixTreeRequest) (api.ChannelPrefixTree, error) {
	var defaultReturnVal api.ChannelPrefixTree
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.IndexChannelPrefixTree(ctx, bearertoken.Token(token), requestArg)
}

func (c *dataSourceServiceClientWithTokenProvider) BatchGetChannelPrefixTrees(ctx context.Context, requestArg api.BatchGetChannelPrefixTreeRequest) (api.BatchGetChannelPrefixTreeResponse, error) {
	var defaultReturnVal api.BatchGetChannelPrefixTreeResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchGetChannelPrefixTrees(ctx, bearertoken.Token(token), requestArg)
}

func (c *dataSourceServiceClientWithTokenProvider) GetAvailableTagsForChannel(ctx context.Context, requestArg api.GetAvailableTagsForChannelRequest) (api.GetAvailableTagsForChannelResponse, error) {
	var defaultReturnVal api.GetAvailableTagsForChannelResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetAvailableTagsForChannel(ctx, bearertoken.Token(token), requestArg)
}

func (c *dataSourceServiceClientWithTokenProvider) GetDataScopeBounds(ctx context.Context, requestArg api.BatchGetDataScopeBoundsRequest) (api.BatchGetDataScopeBoundsResponse, error) {
	var defaultReturnVal api.BatchGetDataScopeBoundsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetDataScopeBounds(ctx, bearertoken.Token(token), requestArg)
}

func (c *dataSourceServiceClientWithTokenProvider) GetTagValuesForDataSource(ctx context.Context, dataSourceRidArg rids.DataSourceRid, requestArg api.GetTagValuesForDataSourceRequest) (map[api1.TagName][]api1.TagValue, error) {
	var defaultReturnVal map[api1.TagName][]api1.TagValue
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetTagValuesForDataSource(ctx, bearertoken.Token(token), dataSourceRidArg, requestArg)
}
