// Code generated by conjure-go. DO NOT EDIT.

package logset

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/datasource/logset/api"
	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

// Log sets are a type of datasource which can be used to store log data.
type LogSetServiceClient interface {
	// Deprecated: Deprecated. Logs should be streamed to a dataset via NominalChannelWriterService#writeLogs.
	Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateLogSetRequest) (api.LogSetMetadata, error)
	// Deprecated: Deprecated. Logs should be streamed to a dataset via NominalChannelWriterService#writeLogs.
	AttachLogsAndFinalize(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid, requestArg api.AttachLogsAndFinalizeRequest) (api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	GetLogSetMetadata(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid) (api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	BatchGetLogSetMetadata(ctx context.Context, authHeader bearertoken.Token, requestArg []api.LogSetRid) ([]api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	SearchLogSets(ctx context.Context, authHeader bearertoken.Token, requestArg api.SearchLogSetsRequest) (api.SearchLogSetsResponse, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	SearchLogs(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid, requestArg api.SearchLogsRequest) (api.SearchLogsResponse, error)
}

type logSetServiceClient struct {
	client httpclient.Client
}

func NewLogSetServiceClient(client httpclient.Client) LogSetServiceClient {
	return &logSetServiceClient{client: client}
}

func (c *logSetServiceClient) Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateLogSetRequest) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	var returnVal *api.LogSetMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Create"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-sets"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "create failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "create response cannot be nil")
	}
	return *returnVal, nil
}

func (c *logSetServiceClient) AttachLogsAndFinalize(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid, requestArg api.AttachLogsAndFinalizeRequest) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	var returnVal *api.LogSetMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("AttachLogsAndFinalize"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-set/%s/attach-and-finalize", url.PathEscape(fmt.Sprint(logSetRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "attachLogsAndFinalize failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "attachLogsAndFinalize response cannot be nil")
	}
	return *returnVal, nil
}

func (c *logSetServiceClient) GetLogSetMetadata(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	var returnVal *api.LogSetMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetLogSetMetadata"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-set/%s", url.PathEscape(fmt.Sprint(logSetRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getLogSetMetadata failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getLogSetMetadata response cannot be nil")
	}
	return *returnVal, nil
}

func (c *logSetServiceClient) BatchGetLogSetMetadata(ctx context.Context, authHeader bearertoken.Token, requestArg []api.LogSetRid) ([]api.LogSetMetadata, error) {
	var returnVal []api.LogSetMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchGetLogSetMetadata"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-set/multiple"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return nil, werror.WrapWithContextParams(ctx, err, "batchGetLogSetMetadata failed")
	}
	if returnVal == nil {
		return nil, werror.ErrorWithContextParams(ctx, "batchGetLogSetMetadata response cannot be nil")
	}
	return returnVal, nil
}

func (c *logSetServiceClient) SearchLogSets(ctx context.Context, authHeader bearertoken.Token, requestArg api.SearchLogSetsRequest) (api.SearchLogSetsResponse, error) {
	var defaultReturnVal api.SearchLogSetsResponse
	var returnVal *api.SearchLogSetsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchLogSets"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-sets/get"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchLogSets failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchLogSets response cannot be nil")
	}
	return *returnVal, nil
}

func (c *logSetServiceClient) SearchLogs(ctx context.Context, authHeader bearertoken.Token, logSetRidArg api.LogSetRid, requestArg api.SearchLogsRequest) (api.SearchLogsResponse, error) {
	var defaultReturnVal api.SearchLogsResponse
	var returnVal *api.SearchLogsResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchLogs"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/data-source/log-set/v1/log-set/%s/logs", url.PathEscape(fmt.Sprint(logSetRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchLogs failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchLogs response cannot be nil")
	}
	return *returnVal, nil
}

// Log sets are a type of datasource which can be used to store log data.
type LogSetServiceClientWithAuth interface {
	// Deprecated: Deprecated. Logs should be streamed to a dataset via NominalChannelWriterService#writeLogs.
	Create(ctx context.Context, requestArg api.CreateLogSetRequest) (api.LogSetMetadata, error)
	// Deprecated: Deprecated. Logs should be streamed to a dataset via NominalChannelWriterService#writeLogs.
	AttachLogsAndFinalize(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.AttachLogsAndFinalizeRequest) (api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	GetLogSetMetadata(ctx context.Context, logSetRidArg api.LogSetRid) (api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	BatchGetLogSetMetadata(ctx context.Context, requestArg []api.LogSetRid) ([]api.LogSetMetadata, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	SearchLogSets(ctx context.Context, requestArg api.SearchLogSetsRequest) (api.SearchLogSetsResponse, error)
	// Deprecated: Logsets have been deprecated and replaced by datasets.
	SearchLogs(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.SearchLogsRequest) (api.SearchLogsResponse, error)
}

func NewLogSetServiceClientWithAuth(client LogSetServiceClient, authHeader bearertoken.Token) LogSetServiceClientWithAuth {
	return &logSetServiceClientWithAuth{client: client, authHeader: authHeader}
}

type logSetServiceClientWithAuth struct {
	client     LogSetServiceClient
	authHeader bearertoken.Token
}

func (c *logSetServiceClientWithAuth) Create(ctx context.Context, requestArg api.CreateLogSetRequest) (api.LogSetMetadata, error) {
	return c.client.Create(ctx, c.authHeader, requestArg)
}

func (c *logSetServiceClientWithAuth) AttachLogsAndFinalize(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.AttachLogsAndFinalizeRequest) (api.LogSetMetadata, error) {
	return c.client.AttachLogsAndFinalize(ctx, c.authHeader, logSetRidArg, requestArg)
}

func (c *logSetServiceClientWithAuth) GetLogSetMetadata(ctx context.Context, logSetRidArg api.LogSetRid) (api.LogSetMetadata, error) {
	return c.client.GetLogSetMetadata(ctx, c.authHeader, logSetRidArg)
}

func (c *logSetServiceClientWithAuth) BatchGetLogSetMetadata(ctx context.Context, requestArg []api.LogSetRid) ([]api.LogSetMetadata, error) {
	return c.client.BatchGetLogSetMetadata(ctx, c.authHeader, requestArg)
}

func (c *logSetServiceClientWithAuth) SearchLogSets(ctx context.Context, requestArg api.SearchLogSetsRequest) (api.SearchLogSetsResponse, error) {
	return c.client.SearchLogSets(ctx, c.authHeader, requestArg)
}

func (c *logSetServiceClientWithAuth) SearchLogs(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.SearchLogsRequest) (api.SearchLogsResponse, error) {
	return c.client.SearchLogs(ctx, c.authHeader, logSetRidArg, requestArg)
}

func NewLogSetServiceClientWithTokenProvider(client LogSetServiceClient, tokenProvider httpclient.TokenProvider) LogSetServiceClientWithAuth {
	return &logSetServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type logSetServiceClientWithTokenProvider struct {
	client        LogSetServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *logSetServiceClientWithTokenProvider) Create(ctx context.Context, requestArg api.CreateLogSetRequest) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.Create(ctx, bearertoken.Token(token), requestArg)
}

func (c *logSetServiceClientWithTokenProvider) AttachLogsAndFinalize(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.AttachLogsAndFinalizeRequest) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.AttachLogsAndFinalize(ctx, bearertoken.Token(token), logSetRidArg, requestArg)
}

func (c *logSetServiceClientWithTokenProvider) GetLogSetMetadata(ctx context.Context, logSetRidArg api.LogSetRid) (api.LogSetMetadata, error) {
	var defaultReturnVal api.LogSetMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetLogSetMetadata(ctx, bearertoken.Token(token), logSetRidArg)
}

func (c *logSetServiceClientWithTokenProvider) BatchGetLogSetMetadata(ctx context.Context, requestArg []api.LogSetRid) ([]api.LogSetMetadata, error) {
	var defaultReturnVal []api.LogSetMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchGetLogSetMetadata(ctx, bearertoken.Token(token), requestArg)
}

func (c *logSetServiceClientWithTokenProvider) SearchLogSets(ctx context.Context, requestArg api.SearchLogSetsRequest) (api.SearchLogSetsResponse, error) {
	var defaultReturnVal api.SearchLogSetsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchLogSets(ctx, bearertoken.Token(token), requestArg)
}

func (c *logSetServiceClientWithTokenProvider) SearchLogs(ctx context.Context, logSetRidArg api.LogSetRid, requestArg api.SearchLogsRequest) (api.SearchLogsResponse, error) {
	var defaultReturnVal api.SearchLogsResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchLogs(ctx, bearertoken.Token(token), logSetRidArg, requestArg)
}
