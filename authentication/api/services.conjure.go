// Code generated by conjure-go. DO NOT EDIT.

package api

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
This service provides operations for managing user and org profiles/settings.
Its name is a bit of a misnomer.
*/
type AuthenticationServiceV2Client interface {
	// Gets the profile of the authenticated user.
	GetMyProfile(ctx context.Context, authHeader bearertoken.Token) (UserV2, error)
	// Updates the profile of the authenticated user.
	UpdateMyProfile(ctx context.Context, authHeader bearertoken.Token, updateMyProfileRequestArg UpdateMyProfileRequest) (UserV2, error)
	// Gets the settings of the authenticated user.
	GetMySettings(ctx context.Context, authHeader bearertoken.Token) (UserSettings, error)
	// Updates the settings of the authenticated user.
	UpdateMySettings(ctx context.Context, authHeader bearertoken.Token, userSettingsArg UserSettings) (UserSettings, error)
	// Gets the settings of the org of the authenticated user.
	GetMyOrgSettings(ctx context.Context, authHeader bearertoken.Token) (OrgSettings, error)
	// Updates the settings of the org of the authenticated user.
	UpdateMyOrgSettings(ctx context.Context, authHeader bearertoken.Token, orgSettingsArg OrgSettings) (OrgSettings, error)
	// Searches for users by email and displayName.
	SearchUsersV2(ctx context.Context, authHeader bearertoken.Token, requestArg SearchUsersRequest) (SearchUsersResponseV2, error)
	// Get users by RID.
	GetUsers(ctx context.Context, authHeader bearertoken.Token, userRidsArg []UserRid) ([]UserV2, error)
	// Gets a user by RID.
	GetUser(ctx context.Context, authHeader bearertoken.Token, userRidArg UserRid) (UserV2, error)
}

type authenticationServiceV2Client struct {
	client httpclient.Client
}

func NewAuthenticationServiceV2Client(client httpclient.Client) AuthenticationServiceV2Client {
	return &authenticationServiceV2Client{client: client}
}

func (c *authenticationServiceV2Client) GetMyProfile(ctx context.Context, authHeader bearertoken.Token) (UserV2, error) {
	var defaultReturnVal UserV2
	var returnVal *UserV2
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetMyProfile"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/my/profile"))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getMyProfile failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getMyProfile response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) UpdateMyProfile(ctx context.Context, authHeader bearertoken.Token, updateMyProfileRequestArg UpdateMyProfileRequest) (UserV2, error) {
	var defaultReturnVal UserV2
	var returnVal *UserV2
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateMyProfile"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("PUT"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/my/profile"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(updateMyProfileRequestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateMyProfile failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateMyProfile response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) GetMySettings(ctx context.Context, authHeader bearertoken.Token) (UserSettings, error) {
	var defaultReturnVal UserSettings
	var returnVal *UserSettings
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetMySettings"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/my/settings"))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getMySettings failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getMySettings response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) UpdateMySettings(ctx context.Context, authHeader bearertoken.Token, userSettingsArg UserSettings) (UserSettings, error) {
	var defaultReturnVal UserSettings
	var returnVal *UserSettings
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateMySettings"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("PUT"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/my/settings"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(userSettingsArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateMySettings failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateMySettings response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) GetMyOrgSettings(ctx context.Context, authHeader bearertoken.Token) (OrgSettings, error) {
	var defaultReturnVal OrgSettings
	var returnVal *OrgSettings
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetMyOrgSettings"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/org/settings"))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getMyOrgSettings failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getMyOrgSettings response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) UpdateMyOrgSettings(ctx context.Context, authHeader bearertoken.Token, orgSettingsArg OrgSettings) (OrgSettings, error) {
	var defaultReturnVal OrgSettings
	var returnVal *OrgSettings
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateMyOrgSettings"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("PUT"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/org/settings"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(orgSettingsArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateMyOrgSettings failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateMyOrgSettings response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) SearchUsersV2(ctx context.Context, authHeader bearertoken.Token, requestArg SearchUsersRequest) (SearchUsersResponseV2, error) {
	var defaultReturnVal SearchUsersResponseV2
	var returnVal *SearchUsersResponseV2
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchUsersV2"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/users"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchUsersV2 failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchUsersV2 response cannot be nil")
	}
	return *returnVal, nil
}

func (c *authenticationServiceV2Client) GetUsers(ctx context.Context, authHeader bearertoken.Token, userRidsArg []UserRid) ([]UserV2, error) {
	var returnVal []UserV2
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetUsers"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/users/batch"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(userRidsArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return nil, werror.WrapWithContextParams(ctx, err, "getUsers failed")
	}
	if returnVal == nil {
		return nil, werror.ErrorWithContextParams(ctx, "getUsers response cannot be nil")
	}
	return returnVal, nil
}

func (c *authenticationServiceV2Client) GetUser(ctx context.Context, authHeader bearertoken.Token, userRidArg UserRid) (UserV2, error) {
	var defaultReturnVal UserV2
	var returnVal *UserV2
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("GetUser"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/authentication/v2/users/%s", url.PathEscape(fmt.Sprint(userRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "getUser failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "getUser response cannot be nil")
	}
	return *returnVal, nil
}

/*
This service provides operations for managing user and org profiles/settings.
Its name is a bit of a misnomer.
*/
type AuthenticationServiceV2ClientWithAuth interface {
	// Gets the profile of the authenticated user.
	GetMyProfile(ctx context.Context) (UserV2, error)
	// Updates the profile of the authenticated user.
	UpdateMyProfile(ctx context.Context, updateMyProfileRequestArg UpdateMyProfileRequest) (UserV2, error)
	// Gets the settings of the authenticated user.
	GetMySettings(ctx context.Context) (UserSettings, error)
	// Updates the settings of the authenticated user.
	UpdateMySettings(ctx context.Context, userSettingsArg UserSettings) (UserSettings, error)
	// Gets the settings of the org of the authenticated user.
	GetMyOrgSettings(ctx context.Context) (OrgSettings, error)
	// Updates the settings of the org of the authenticated user.
	UpdateMyOrgSettings(ctx context.Context, orgSettingsArg OrgSettings) (OrgSettings, error)
	// Searches for users by email and displayName.
	SearchUsersV2(ctx context.Context, requestArg SearchUsersRequest) (SearchUsersResponseV2, error)
	// Get users by RID.
	GetUsers(ctx context.Context, userRidsArg []UserRid) ([]UserV2, error)
	// Gets a user by RID.
	GetUser(ctx context.Context, userRidArg UserRid) (UserV2, error)
}

func NewAuthenticationServiceV2ClientWithAuth(client AuthenticationServiceV2Client, authHeader bearertoken.Token) AuthenticationServiceV2ClientWithAuth {
	return &authenticationServiceV2ClientWithAuth{client: client, authHeader: authHeader}
}

type authenticationServiceV2ClientWithAuth struct {
	client     AuthenticationServiceV2Client
	authHeader bearertoken.Token
}

func (c *authenticationServiceV2ClientWithAuth) GetMyProfile(ctx context.Context) (UserV2, error) {
	return c.client.GetMyProfile(ctx, c.authHeader)
}

func (c *authenticationServiceV2ClientWithAuth) UpdateMyProfile(ctx context.Context, updateMyProfileRequestArg UpdateMyProfileRequest) (UserV2, error) {
	return c.client.UpdateMyProfile(ctx, c.authHeader, updateMyProfileRequestArg)
}

func (c *authenticationServiceV2ClientWithAuth) GetMySettings(ctx context.Context) (UserSettings, error) {
	return c.client.GetMySettings(ctx, c.authHeader)
}

func (c *authenticationServiceV2ClientWithAuth) UpdateMySettings(ctx context.Context, userSettingsArg UserSettings) (UserSettings, error) {
	return c.client.UpdateMySettings(ctx, c.authHeader, userSettingsArg)
}

func (c *authenticationServiceV2ClientWithAuth) GetMyOrgSettings(ctx context.Context) (OrgSettings, error) {
	return c.client.GetMyOrgSettings(ctx, c.authHeader)
}

func (c *authenticationServiceV2ClientWithAuth) UpdateMyOrgSettings(ctx context.Context, orgSettingsArg OrgSettings) (OrgSettings, error) {
	return c.client.UpdateMyOrgSettings(ctx, c.authHeader, orgSettingsArg)
}

func (c *authenticationServiceV2ClientWithAuth) SearchUsersV2(ctx context.Context, requestArg SearchUsersRequest) (SearchUsersResponseV2, error) {
	return c.client.SearchUsersV2(ctx, c.authHeader, requestArg)
}

func (c *authenticationServiceV2ClientWithAuth) GetUsers(ctx context.Context, userRidsArg []UserRid) ([]UserV2, error) {
	return c.client.GetUsers(ctx, c.authHeader, userRidsArg)
}

func (c *authenticationServiceV2ClientWithAuth) GetUser(ctx context.Context, userRidArg UserRid) (UserV2, error) {
	return c.client.GetUser(ctx, c.authHeader, userRidArg)
}

func NewAuthenticationServiceV2ClientWithTokenProvider(client AuthenticationServiceV2Client, tokenProvider httpclient.TokenProvider) AuthenticationServiceV2ClientWithAuth {
	return &authenticationServiceV2ClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type authenticationServiceV2ClientWithTokenProvider struct {
	client        AuthenticationServiceV2Client
	tokenProvider httpclient.TokenProvider
}

func (c *authenticationServiceV2ClientWithTokenProvider) GetMyProfile(ctx context.Context) (UserV2, error) {
	var defaultReturnVal UserV2
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetMyProfile(ctx, bearertoken.Token(token))
}

func (c *authenticationServiceV2ClientWithTokenProvider) UpdateMyProfile(ctx context.Context, updateMyProfileRequestArg UpdateMyProfileRequest) (UserV2, error) {
	var defaultReturnVal UserV2
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateMyProfile(ctx, bearertoken.Token(token), updateMyProfileRequestArg)
}

func (c *authenticationServiceV2ClientWithTokenProvider) GetMySettings(ctx context.Context) (UserSettings, error) {
	var defaultReturnVal UserSettings
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetMySettings(ctx, bearertoken.Token(token))
}

func (c *authenticationServiceV2ClientWithTokenProvider) UpdateMySettings(ctx context.Context, userSettingsArg UserSettings) (UserSettings, error) {
	var defaultReturnVal UserSettings
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateMySettings(ctx, bearertoken.Token(token), userSettingsArg)
}

func (c *authenticationServiceV2ClientWithTokenProvider) GetMyOrgSettings(ctx context.Context) (OrgSettings, error) {
	var defaultReturnVal OrgSettings
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetMyOrgSettings(ctx, bearertoken.Token(token))
}

func (c *authenticationServiceV2ClientWithTokenProvider) UpdateMyOrgSettings(ctx context.Context, orgSettingsArg OrgSettings) (OrgSettings, error) {
	var defaultReturnVal OrgSettings
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateMyOrgSettings(ctx, bearertoken.Token(token), orgSettingsArg)
}

func (c *authenticationServiceV2ClientWithTokenProvider) SearchUsersV2(ctx context.Context, requestArg SearchUsersRequest) (SearchUsersResponseV2, error) {
	var defaultReturnVal SearchUsersResponseV2
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchUsersV2(ctx, bearertoken.Token(token), requestArg)
}

func (c *authenticationServiceV2ClientWithTokenProvider) GetUsers(ctx context.Context, userRidsArg []UserRid) ([]UserV2, error) {
	var defaultReturnVal []UserV2
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetUsers(ctx, bearertoken.Token(token), userRidsArg)
}

func (c *authenticationServiceV2ClientWithTokenProvider) GetUser(ctx context.Context, userRidArg UserRid) (UserV2, error) {
	var defaultReturnVal UserV2
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.GetUser(ctx, bearertoken.Token(token), userRidArg)
}
