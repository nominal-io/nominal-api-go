// Code generated by conjure-go. DO NOT EDIT.

package archetype

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	api1 "github.com/nominal-io/nominal-api-go/io/nominal/api"
	"github.com/nominal-io/nominal-api-go/timeseries/archetype/api"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
[INTERNAL]
A series archetype represents the constant information about data in a series - specifically, the name, units, a
description, and the tags. Series archetypes can be used to query points from specific series depending on the tag
value selections.
*/
type SeriesArchetypeServiceClient interface {
	// Batch get series archetypes by DataSourceRid.
	BatchGet(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetSeriesArchetypeRequest) (api.BatchGetSeriesArchetypeResponse, error)
	// Create a new series archetype.
	Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateSeriesArchetypeRequest) error
	// Idempotently creates series archetypes.
	BatchCreate(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateSeriesArchetypeRequest) error
	// Get a series archetype from its series archetype rid.
	Get(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesArchetypeRid) (api.SeriesArchetype, error)
	/*
	   Update the metadata on an existing series archetype.
	   Throws SeriesArchetypeNotFound if the series archetype does not exist.
	*/
	UpdateMetadata(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesArchetypeRid, requestArg api.UpdateSeriesArchetypeMetadataRequest) (api.SeriesArchetype, error)
}

type seriesArchetypeServiceClient struct {
	client httpclient.Client
}

func NewSeriesArchetypeServiceClient(client httpclient.Client) SeriesArchetypeServiceClient {
	return &seriesArchetypeServiceClient{client: client}
}

func (c *seriesArchetypeServiceClient) BatchGet(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetSeriesArchetypeRequest) (api.BatchGetSeriesArchetypeResponse, error) {
	var defaultReturnVal api.BatchGetSeriesArchetypeResponse
	var returnVal *api.BatchGetSeriesArchetypeResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchGet"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/batch-get"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchGet failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchGet response cannot be nil")
	}
	return *returnVal, nil
}

func (c *seriesArchetypeServiceClient) Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateSeriesArchetypeRequest) error {
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Create"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return werror.WrapWithContextParams(ctx, err, "create failed")
	}
	return nil
}

func (c *seriesArchetypeServiceClient) BatchCreate(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateSeriesArchetypeRequest) error {
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchCreate"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/batch-create"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return werror.WrapWithContextParams(ctx, err, "batchCreate failed")
	}
	return nil
}

func (c *seriesArchetypeServiceClient) Get(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesArchetypeRid) (api.SeriesArchetype, error) {
	var defaultReturnVal api.SeriesArchetype
	var returnVal *api.SeriesArchetype
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Get"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/%s", url.PathEscape(fmt.Sprint(ridArg))))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "get failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "get response cannot be nil")
	}
	return *returnVal, nil
}

func (c *seriesArchetypeServiceClient) UpdateMetadata(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesArchetypeRid, requestArg api.UpdateSeriesArchetypeMetadataRequest) (api.SeriesArchetype, error) {
	var defaultReturnVal api.SeriesArchetype
	var returnVal *api.SeriesArchetype
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateMetadata"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/%s/metadata", url.PathEscape(fmt.Sprint(ridArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateMetadata failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateMetadata response cannot be nil")
	}
	return *returnVal, nil
}

/*
[INTERNAL]
A series archetype represents the constant information about data in a series - specifically, the name, units, a
description, and the tags. Series archetypes can be used to query points from specific series depending on the tag
value selections.
*/
type SeriesArchetypeServiceClientWithAuth interface {
	// Batch get series archetypes by DataSourceRid.
	BatchGet(ctx context.Context, requestArg api.BatchGetSeriesArchetypeRequest) (api.BatchGetSeriesArchetypeResponse, error)
	// Create a new series archetype.
	Create(ctx context.Context, requestArg api.CreateSeriesArchetypeRequest) error
	// Idempotently creates series archetypes.
	BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesArchetypeRequest) error
	// Get a series archetype from its series archetype rid.
	Get(ctx context.Context, ridArg api1.SeriesArchetypeRid) (api.SeriesArchetype, error)
	/*
	   Update the metadata on an existing series archetype.
	   Throws SeriesArchetypeNotFound if the series archetype does not exist.
	*/
	UpdateMetadata(ctx context.Context, ridArg api1.SeriesArchetypeRid, requestArg api.UpdateSeriesArchetypeMetadataRequest) (api.SeriesArchetype, error)
}

func NewSeriesArchetypeServiceClientWithAuth(client SeriesArchetypeServiceClient, authHeader bearertoken.Token) SeriesArchetypeServiceClientWithAuth {
	return &seriesArchetypeServiceClientWithAuth{client: client, authHeader: authHeader}
}

type seriesArchetypeServiceClientWithAuth struct {
	client     SeriesArchetypeServiceClient
	authHeader bearertoken.Token
}

func (c *seriesArchetypeServiceClientWithAuth) BatchGet(ctx context.Context, requestArg api.BatchGetSeriesArchetypeRequest) (api.BatchGetSeriesArchetypeResponse, error) {
	return c.client.BatchGet(ctx, c.authHeader, requestArg)
}

func (c *seriesArchetypeServiceClientWithAuth) Create(ctx context.Context, requestArg api.CreateSeriesArchetypeRequest) error {
	return c.client.Create(ctx, c.authHeader, requestArg)
}

func (c *seriesArchetypeServiceClientWithAuth) BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesArchetypeRequest) error {
	return c.client.BatchCreate(ctx, c.authHeader, requestArg)
}

func (c *seriesArchetypeServiceClientWithAuth) Get(ctx context.Context, ridArg api1.SeriesArchetypeRid) (api.SeriesArchetype, error) {
	return c.client.Get(ctx, c.authHeader, ridArg)
}

func (c *seriesArchetypeServiceClientWithAuth) UpdateMetadata(ctx context.Context, ridArg api1.SeriesArchetypeRid, requestArg api.UpdateSeriesArchetypeMetadataRequest) (api.SeriesArchetype, error) {
	return c.client.UpdateMetadata(ctx, c.authHeader, ridArg, requestArg)
}

func NewSeriesArchetypeServiceClientWithTokenProvider(client SeriesArchetypeServiceClient, tokenProvider httpclient.TokenProvider) SeriesArchetypeServiceClientWithAuth {
	return &seriesArchetypeServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type seriesArchetypeServiceClientWithTokenProvider struct {
	client        SeriesArchetypeServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *seriesArchetypeServiceClientWithTokenProvider) BatchGet(ctx context.Context, requestArg api.BatchGetSeriesArchetypeRequest) (api.BatchGetSeriesArchetypeResponse, error) {
	var defaultReturnVal api.BatchGetSeriesArchetypeResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchGet(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesArchetypeServiceClientWithTokenProvider) Create(ctx context.Context, requestArg api.CreateSeriesArchetypeRequest) error {
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return err
	}
	return c.client.Create(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesArchetypeServiceClientWithTokenProvider) BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesArchetypeRequest) error {
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return err
	}
	return c.client.BatchCreate(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesArchetypeServiceClientWithTokenProvider) Get(ctx context.Context, ridArg api1.SeriesArchetypeRid) (api.SeriesArchetype, error) {
	var defaultReturnVal api.SeriesArchetype
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.Get(ctx, bearertoken.Token(token), ridArg)
}

func (c *seriesArchetypeServiceClientWithTokenProvider) UpdateMetadata(ctx context.Context, ridArg api1.SeriesArchetypeRid, requestArg api.UpdateSeriesArchetypeMetadataRequest) (api.SeriesArchetype, error) {
	var defaultReturnVal api.SeriesArchetype
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateMetadata(ctx, bearertoken.Token(token), ridArg, requestArg)
}
