// Code generated by conjure-go. DO NOT EDIT.

package metadata

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	api1 "github.com/nominal-io/nominal-api-go/io/nominal/api"
	"github.com/nominal-io/nominal-api-go/timeseries/metadata/api"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
[INTERNAL]
Series metadata represents the constant information about data in a series - specifically, the name, units, a
description, and the tags. Series metadata can be used to query points from specific series depending on the tag
value selections.
*/
type SeriesMetadataServiceClient interface {
	// Batch get series metadata by DataSourceRid.
	BatchGet(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetSeriesMetadataRequest) (api.BatchGetSeriesMetadataResponse, error)
	// Create new series metadata.
	Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateSeriesMetadataRequest) error
	// Idempotently creates series metadata.
	BatchCreate(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateSeriesMetadataRequest) error
	// Get series metadata from its series metadata rid.
	Get(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesMetadataRid) (api.SeriesMetadata, error)
	/*
	   Update existing series metadata.
	   Throws SeriesMetadataNotFound if the series metadata does not exist.
	*/
	UpdateMetadata(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesMetadataRid, requestArg api.UpdateSeriesMetadataRequest) (api.SeriesMetadata, error)
	/*
	   Batch creates series metadata for video channels if they don't exist.
	   Idempotent - returns existing SeriesMetadataRid if already exists.
	*/
	BatchCreateVideoSeries(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateVideoSeriesRequest) (api.BatchCreateVideoSeriesResponse, error)
}

type seriesMetadataServiceClient struct {
	client httpclient.Client
}

func NewSeriesMetadataServiceClient(client httpclient.Client) SeriesMetadataServiceClient {
	return &seriesMetadataServiceClient{client: client}
}

func (c *seriesMetadataServiceClient) BatchGet(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchGetSeriesMetadataRequest) (api.BatchGetSeriesMetadataResponse, error) {
	var defaultReturnVal api.BatchGetSeriesMetadataResponse
	var returnVal *api.BatchGetSeriesMetadataResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchGet"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/batch-get"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchGet failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchGet response cannot be nil")
	}
	return *returnVal, nil
}

func (c *seriesMetadataServiceClient) Create(ctx context.Context, authHeader bearertoken.Token, requestArg api.CreateSeriesMetadataRequest) error {
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Create"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return werror.WrapWithContextParams(ctx, err, "create failed")
	}
	return nil
}

func (c *seriesMetadataServiceClient) BatchCreate(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateSeriesMetadataRequest) error {
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchCreate"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/batch-create"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return werror.WrapWithContextParams(ctx, err, "batchCreate failed")
	}
	return nil
}

func (c *seriesMetadataServiceClient) Get(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesMetadataRid) (api.SeriesMetadata, error) {
	var defaultReturnVal api.SeriesMetadata
	var returnVal *api.SeriesMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Get"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("GET"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/%s", url.PathEscape(fmt.Sprint(ridArg))))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "get failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "get response cannot be nil")
	}
	return *returnVal, nil
}

func (c *seriesMetadataServiceClient) UpdateMetadata(ctx context.Context, authHeader bearertoken.Token, ridArg api1.SeriesMetadataRid, requestArg api.UpdateSeriesMetadataRequest) (api.SeriesMetadata, error) {
	var defaultReturnVal api.SeriesMetadata
	var returnVal *api.SeriesMetadata
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateMetadata"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/%s/metadata", url.PathEscape(fmt.Sprint(ridArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateMetadata failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateMetadata response cannot be nil")
	}
	return *returnVal, nil
}

func (c *seriesMetadataServiceClient) BatchCreateVideoSeries(ctx context.Context, authHeader bearertoken.Token, requestArg api.BatchCreateVideoSeriesRequest) (api.BatchCreateVideoSeriesResponse, error) {
	var defaultReturnVal api.BatchCreateVideoSeriesResponse
	var returnVal *api.BatchCreateVideoSeriesResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchCreateVideoSeries"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/timeseries/archetype/v1/series-archetype/video-channel"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchCreateVideoSeries failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchCreateVideoSeries response cannot be nil")
	}
	return *returnVal, nil
}

/*
[INTERNAL]
Series metadata represents the constant information about data in a series - specifically, the name, units, a
description, and the tags. Series metadata can be used to query points from specific series depending on the tag
value selections.
*/
type SeriesMetadataServiceClientWithAuth interface {
	// Batch get series metadata by DataSourceRid.
	BatchGet(ctx context.Context, requestArg api.BatchGetSeriesMetadataRequest) (api.BatchGetSeriesMetadataResponse, error)
	// Create new series metadata.
	Create(ctx context.Context, requestArg api.CreateSeriesMetadataRequest) error
	// Idempotently creates series metadata.
	BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesMetadataRequest) error
	// Get series metadata from its series metadata rid.
	Get(ctx context.Context, ridArg api1.SeriesMetadataRid) (api.SeriesMetadata, error)
	/*
	   Update existing series metadata.
	   Throws SeriesMetadataNotFound if the series metadata does not exist.
	*/
	UpdateMetadata(ctx context.Context, ridArg api1.SeriesMetadataRid, requestArg api.UpdateSeriesMetadataRequest) (api.SeriesMetadata, error)
	/*
	   Batch creates series metadata for video channels if they don't exist.
	   Idempotent - returns existing SeriesMetadataRid if already exists.
	*/
	BatchCreateVideoSeries(ctx context.Context, requestArg api.BatchCreateVideoSeriesRequest) (api.BatchCreateVideoSeriesResponse, error)
}

func NewSeriesMetadataServiceClientWithAuth(client SeriesMetadataServiceClient, authHeader bearertoken.Token) SeriesMetadataServiceClientWithAuth {
	return &seriesMetadataServiceClientWithAuth{client: client, authHeader: authHeader}
}

type seriesMetadataServiceClientWithAuth struct {
	client     SeriesMetadataServiceClient
	authHeader bearertoken.Token
}

func (c *seriesMetadataServiceClientWithAuth) BatchGet(ctx context.Context, requestArg api.BatchGetSeriesMetadataRequest) (api.BatchGetSeriesMetadataResponse, error) {
	return c.client.BatchGet(ctx, c.authHeader, requestArg)
}

func (c *seriesMetadataServiceClientWithAuth) Create(ctx context.Context, requestArg api.CreateSeriesMetadataRequest) error {
	return c.client.Create(ctx, c.authHeader, requestArg)
}

func (c *seriesMetadataServiceClientWithAuth) BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesMetadataRequest) error {
	return c.client.BatchCreate(ctx, c.authHeader, requestArg)
}

func (c *seriesMetadataServiceClientWithAuth) Get(ctx context.Context, ridArg api1.SeriesMetadataRid) (api.SeriesMetadata, error) {
	return c.client.Get(ctx, c.authHeader, ridArg)
}

func (c *seriesMetadataServiceClientWithAuth) UpdateMetadata(ctx context.Context, ridArg api1.SeriesMetadataRid, requestArg api.UpdateSeriesMetadataRequest) (api.SeriesMetadata, error) {
	return c.client.UpdateMetadata(ctx, c.authHeader, ridArg, requestArg)
}

func (c *seriesMetadataServiceClientWithAuth) BatchCreateVideoSeries(ctx context.Context, requestArg api.BatchCreateVideoSeriesRequest) (api.BatchCreateVideoSeriesResponse, error) {
	return c.client.BatchCreateVideoSeries(ctx, c.authHeader, requestArg)
}

func NewSeriesMetadataServiceClientWithTokenProvider(client SeriesMetadataServiceClient, tokenProvider httpclient.TokenProvider) SeriesMetadataServiceClientWithAuth {
	return &seriesMetadataServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type seriesMetadataServiceClientWithTokenProvider struct {
	client        SeriesMetadataServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *seriesMetadataServiceClientWithTokenProvider) BatchGet(ctx context.Context, requestArg api.BatchGetSeriesMetadataRequest) (api.BatchGetSeriesMetadataResponse, error) {
	var defaultReturnVal api.BatchGetSeriesMetadataResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchGet(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesMetadataServiceClientWithTokenProvider) Create(ctx context.Context, requestArg api.CreateSeriesMetadataRequest) error {
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return err
	}
	return c.client.Create(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesMetadataServiceClientWithTokenProvider) BatchCreate(ctx context.Context, requestArg api.BatchCreateSeriesMetadataRequest) error {
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return err
	}
	return c.client.BatchCreate(ctx, bearertoken.Token(token), requestArg)
}

func (c *seriesMetadataServiceClientWithTokenProvider) Get(ctx context.Context, ridArg api1.SeriesMetadataRid) (api.SeriesMetadata, error) {
	var defaultReturnVal api.SeriesMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.Get(ctx, bearertoken.Token(token), ridArg)
}

func (c *seriesMetadataServiceClientWithTokenProvider) UpdateMetadata(ctx context.Context, ridArg api1.SeriesMetadataRid, requestArg api.UpdateSeriesMetadataRequest) (api.SeriesMetadata, error) {
	var defaultReturnVal api.SeriesMetadata
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateMetadata(ctx, bearertoken.Token(token), ridArg, requestArg)
}

func (c *seriesMetadataServiceClientWithTokenProvider) BatchCreateVideoSeries(ctx context.Context, requestArg api.BatchCreateVideoSeriesRequest) (api.BatchCreateVideoSeriesResponse, error) {
	var defaultReturnVal api.BatchCreateVideoSeriesResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchCreateVideoSeries(ctx, bearertoken.Token(token), requestArg)
}
