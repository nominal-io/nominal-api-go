// Code generated by conjure-go. DO NOT EDIT.

package api

import (
	"context"
	"fmt"

	"github.com/nominal-io/nominal-api/internal/conjureerrors"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

// For internal user only. Contact Nominal support if you need to delete data.
type InternalNominalStorageDataDeletionServiceClient interface {
	/*
	   Deletes stored data. This is an irreversible operation so be careful about specified
	   time range and tag scope.
	*/
	Delete(ctx context.Context, authHeader bearertoken.Token, requestArg DeleteDataRequest) error
}

type internalNominalStorageDataDeletionServiceClient struct {
	client httpclient.Client
}

func NewInternalNominalStorageDataDeletionServiceClient(client httpclient.Client) InternalNominalStorageDataDeletionServiceClient {
	return &internalNominalStorageDataDeletionServiceClient{client: client}
}

func (c *internalNominalStorageDataDeletionServiceClient) Delete(ctx context.Context, authHeader bearertoken.Token, requestArg DeleteDataRequest) error {
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("Delete"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/internal/storage-data-deletion/v1/delete-data"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return werror.WrapWithContextParams(ctx, err, "delete failed")
	}
	return nil
}

// For internal user only. Contact Nominal support if you need to delete data.
type InternalNominalStorageDataDeletionServiceClientWithAuth interface {
	/*
	   Deletes stored data. This is an irreversible operation so be careful about specified
	   time range and tag scope.
	*/
	Delete(ctx context.Context, requestArg DeleteDataRequest) error
}

func NewInternalNominalStorageDataDeletionServiceClientWithAuth(client InternalNominalStorageDataDeletionServiceClient, authHeader bearertoken.Token) InternalNominalStorageDataDeletionServiceClientWithAuth {
	return &internalNominalStorageDataDeletionServiceClientWithAuth{client: client, authHeader: authHeader}
}

type internalNominalStorageDataDeletionServiceClientWithAuth struct {
	client     InternalNominalStorageDataDeletionServiceClient
	authHeader bearertoken.Token
}

func (c *internalNominalStorageDataDeletionServiceClientWithAuth) Delete(ctx context.Context, requestArg DeleteDataRequest) error {
	return c.client.Delete(ctx, c.authHeader, requestArg)
}

func NewInternalNominalStorageDataDeletionServiceClientWithTokenProvider(client InternalNominalStorageDataDeletionServiceClient, tokenProvider httpclient.TokenProvider) InternalNominalStorageDataDeletionServiceClientWithAuth {
	return &internalNominalStorageDataDeletionServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type internalNominalStorageDataDeletionServiceClientWithTokenProvider struct {
	client        InternalNominalStorageDataDeletionServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *internalNominalStorageDataDeletionServiceClientWithTokenProvider) Delete(ctx context.Context, requestArg DeleteDataRequest) error {
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return err
	}
	return c.client.Delete(ctx, bearertoken.Token(token), requestArg)
}
