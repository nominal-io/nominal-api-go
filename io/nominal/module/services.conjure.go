// Code generated by conjure-go. DO NOT EDIT.

package module

import (
	"context"
	"fmt"
	"net/url"

	"github.com/nominal-io/nominal-api-go/internal/conjureerrors"
	"github.com/nominal-io/nominal-api-go/modules/api"
	"github.com/palantir/conjure-go-runtime/v2/conjure-go-client/httpclient"
	"github.com/palantir/pkg/bearertoken"
	werror "github.com/palantir/witchcraft-go-error"
)

/*
Modules define collections of compute logic that can be shared and used across different contexts.
The Modules Service provides the API for managing these collections of functions.
*/
type ModuleServiceClient interface {
	// Create a new module.
	CreateModule(ctx context.Context, authHeader bearertoken.Token, requestArg CreateModuleRequest) (Module, error)
	// Update an existing module.
	UpdateModule(ctx context.Context, authHeader bearertoken.Token, moduleRidArg api.ModuleRid, requestArg UpdateModuleRequest) (Module, error)
	// Get a list of modules by their RIDs and version specifiers if provided.
	BatchGetModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchGetModulesRequest) ([]Module, error)
	// Search for modules.
	SearchModules(ctx context.Context, authHeader bearertoken.Token, requestArg SearchModulesRequest) (SearchModulesResponse, error)
	// Archive a set of modules.
	BatchArchiveModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchArchiveModulesRequest) (BatchArchiveModulesResponse, error)
	// Unarchive a set of modules.
	BatchUnarchiveModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchUnarchiveModulesRequest) (BatchUnarchiveModulesResponse, error)
}

type moduleServiceClient struct {
	client httpclient.Client
}

func NewModuleServiceClient(client httpclient.Client) ModuleServiceClient {
	return &moduleServiceClient{client: client}
}

func (c *moduleServiceClient) CreateModule(ctx context.Context, authHeader bearertoken.Token, requestArg CreateModuleRequest) (Module, error) {
	var defaultReturnVal Module
	var returnVal *Module
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("CreateModule"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "createModule failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "createModule response cannot be nil")
	}
	return *returnVal, nil
}

func (c *moduleServiceClient) UpdateModule(ctx context.Context, authHeader bearertoken.Token, moduleRidArg api.ModuleRid, requestArg UpdateModuleRequest) (Module, error) {
	var defaultReturnVal Module
	var returnVal *Module
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("UpdateModule"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("PUT"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module/%s", url.PathEscape(fmt.Sprint(moduleRidArg))))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "updateModule failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "updateModule response cannot be nil")
	}
	return *returnVal, nil
}

func (c *moduleServiceClient) BatchGetModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchGetModulesRequest) ([]Module, error) {
	var returnVal []Module
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchGetModules"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module/batch-get"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return nil, werror.WrapWithContextParams(ctx, err, "batchGetModules failed")
	}
	if returnVal == nil {
		return nil, werror.ErrorWithContextParams(ctx, "batchGetModules response cannot be nil")
	}
	return returnVal, nil
}

func (c *moduleServiceClient) SearchModules(ctx context.Context, authHeader bearertoken.Token, requestArg SearchModulesRequest) (SearchModulesResponse, error) {
	var defaultReturnVal SearchModulesResponse
	var returnVal *SearchModulesResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("SearchModules"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module/search"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "searchModules failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "searchModules response cannot be nil")
	}
	return *returnVal, nil
}

func (c *moduleServiceClient) BatchArchiveModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchArchiveModulesRequest) (BatchArchiveModulesResponse, error) {
	var defaultReturnVal BatchArchiveModulesResponse
	var returnVal *BatchArchiveModulesResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchArchiveModules"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module/archive"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchArchiveModules failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchArchiveModules response cannot be nil")
	}
	return *returnVal, nil
}

func (c *moduleServiceClient) BatchUnarchiveModules(ctx context.Context, authHeader bearertoken.Token, requestArg BatchUnarchiveModulesRequest) (BatchUnarchiveModulesResponse, error) {
	var defaultReturnVal BatchUnarchiveModulesResponse
	var returnVal *BatchUnarchiveModulesResponse
	var requestParams []httpclient.RequestParam
	requestParams = append(requestParams, httpclient.WithRPCMethodName("BatchUnarchiveModules"))
	requestParams = append(requestParams, httpclient.WithRequestMethod("POST"))
	requestParams = append(requestParams, httpclient.WithHeader("Authorization", fmt.Sprint("Bearer ", authHeader)))
	requestParams = append(requestParams, httpclient.WithPathf("/scout/v2/module/unarchive"))
	requestParams = append(requestParams, httpclient.WithJSONRequest(requestArg))
	requestParams = append(requestParams, httpclient.WithJSONResponse(&returnVal))
	requestParams = append(requestParams, httpclient.WithRequestConjureErrorDecoder(conjureerrors.Decoder()))
	if _, err := c.client.Do(ctx, requestParams...); err != nil {
		return defaultReturnVal, werror.WrapWithContextParams(ctx, err, "batchUnarchiveModules failed")
	}
	if returnVal == nil {
		return defaultReturnVal, werror.ErrorWithContextParams(ctx, "batchUnarchiveModules response cannot be nil")
	}
	return *returnVal, nil
}

/*
Modules define collections of compute logic that can be shared and used across different contexts.
The Modules Service provides the API for managing these collections of functions.
*/
type ModuleServiceClientWithAuth interface {
	// Create a new module.
	CreateModule(ctx context.Context, requestArg CreateModuleRequest) (Module, error)
	// Update an existing module.
	UpdateModule(ctx context.Context, moduleRidArg api.ModuleRid, requestArg UpdateModuleRequest) (Module, error)
	// Get a list of modules by their RIDs and version specifiers if provided.
	BatchGetModules(ctx context.Context, requestArg BatchGetModulesRequest) ([]Module, error)
	// Search for modules.
	SearchModules(ctx context.Context, requestArg SearchModulesRequest) (SearchModulesResponse, error)
	// Archive a set of modules.
	BatchArchiveModules(ctx context.Context, requestArg BatchArchiveModulesRequest) (BatchArchiveModulesResponse, error)
	// Unarchive a set of modules.
	BatchUnarchiveModules(ctx context.Context, requestArg BatchUnarchiveModulesRequest) (BatchUnarchiveModulesResponse, error)
}

func NewModuleServiceClientWithAuth(client ModuleServiceClient, authHeader bearertoken.Token) ModuleServiceClientWithAuth {
	return &moduleServiceClientWithAuth{client: client, authHeader: authHeader}
}

type moduleServiceClientWithAuth struct {
	client     ModuleServiceClient
	authHeader bearertoken.Token
}

func (c *moduleServiceClientWithAuth) CreateModule(ctx context.Context, requestArg CreateModuleRequest) (Module, error) {
	return c.client.CreateModule(ctx, c.authHeader, requestArg)
}

func (c *moduleServiceClientWithAuth) UpdateModule(ctx context.Context, moduleRidArg api.ModuleRid, requestArg UpdateModuleRequest) (Module, error) {
	return c.client.UpdateModule(ctx, c.authHeader, moduleRidArg, requestArg)
}

func (c *moduleServiceClientWithAuth) BatchGetModules(ctx context.Context, requestArg BatchGetModulesRequest) ([]Module, error) {
	return c.client.BatchGetModules(ctx, c.authHeader, requestArg)
}

func (c *moduleServiceClientWithAuth) SearchModules(ctx context.Context, requestArg SearchModulesRequest) (SearchModulesResponse, error) {
	return c.client.SearchModules(ctx, c.authHeader, requestArg)
}

func (c *moduleServiceClientWithAuth) BatchArchiveModules(ctx context.Context, requestArg BatchArchiveModulesRequest) (BatchArchiveModulesResponse, error) {
	return c.client.BatchArchiveModules(ctx, c.authHeader, requestArg)
}

func (c *moduleServiceClientWithAuth) BatchUnarchiveModules(ctx context.Context, requestArg BatchUnarchiveModulesRequest) (BatchUnarchiveModulesResponse, error) {
	return c.client.BatchUnarchiveModules(ctx, c.authHeader, requestArg)
}

func NewModuleServiceClientWithTokenProvider(client ModuleServiceClient, tokenProvider httpclient.TokenProvider) ModuleServiceClientWithAuth {
	return &moduleServiceClientWithTokenProvider{client: client, tokenProvider: tokenProvider}
}

type moduleServiceClientWithTokenProvider struct {
	client        ModuleServiceClient
	tokenProvider httpclient.TokenProvider
}

func (c *moduleServiceClientWithTokenProvider) CreateModule(ctx context.Context, requestArg CreateModuleRequest) (Module, error) {
	var defaultReturnVal Module
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.CreateModule(ctx, bearertoken.Token(token), requestArg)
}

func (c *moduleServiceClientWithTokenProvider) UpdateModule(ctx context.Context, moduleRidArg api.ModuleRid, requestArg UpdateModuleRequest) (Module, error) {
	var defaultReturnVal Module
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.UpdateModule(ctx, bearertoken.Token(token), moduleRidArg, requestArg)
}

func (c *moduleServiceClientWithTokenProvider) BatchGetModules(ctx context.Context, requestArg BatchGetModulesRequest) ([]Module, error) {
	var defaultReturnVal []Module
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchGetModules(ctx, bearertoken.Token(token), requestArg)
}

func (c *moduleServiceClientWithTokenProvider) SearchModules(ctx context.Context, requestArg SearchModulesRequest) (SearchModulesResponse, error) {
	var defaultReturnVal SearchModulesResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.SearchModules(ctx, bearertoken.Token(token), requestArg)
}

func (c *moduleServiceClientWithTokenProvider) BatchArchiveModules(ctx context.Context, requestArg BatchArchiveModulesRequest) (BatchArchiveModulesResponse, error) {
	var defaultReturnVal BatchArchiveModulesResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchArchiveModules(ctx, bearertoken.Token(token), requestArg)
}

func (c *moduleServiceClientWithTokenProvider) BatchUnarchiveModules(ctx context.Context, requestArg BatchUnarchiveModulesRequest) (BatchUnarchiveModulesResponse, error) {
	var defaultReturnVal BatchUnarchiveModulesResponse
	token, err := c.tokenProvider(ctx)
	if err != nil {
		return defaultReturnVal, err
	}
	return c.client.BatchUnarchiveModules(ctx, bearertoken.Token(token), requestArg)
}
